<!DOCTYPE html>
<!-- {{VERSION}} -->
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title>t('app.title')</title>
    <style>
        {{CSS}}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>t('app.title')</h1>
            <p>t('app.tagline')</p>
            
            <!-- Global Search -->
            <div class="global-search">
                <div class="search-container">
                    <input type="text" id="globalSearch" placeholder="t('search.placeholder')" autocomplete="off">
                    <button class="hashtag-browser-btn" onclick="showHashtagBrowser()" title="t('search.browseHashtags')">🏷️</button>
                    <div class="search-results" id="searchResults" style="display: none;"></div>
                </div>
            </div>
            
            <div class="nav">
                <div class="nav-left">
                    <button class="nav-btn active" onclick="showSection('tracker', event)">t('navigation.tracker')</button>
                    <button class="nav-btn" onclick="showSection('todo', event)">t('navigation.todo')</button>
                    <button class="nav-btn" onclick="showSection('notes', event)">t('navigation.notes')</button>
                </div>
                <div class="nav-right">
                    <button id="overdueAlertButton" class="nav-btn alert-btn" onclick="showOverdueAlert()" style="display: none;" title="t('navigation.alertTitle')">t('navigation.alert')</button>
                    <button id="pauseButton" class="nav-btn" onclick="togglePause()">t('navigation.startReminders')</button>
                    <button id="pomodoroButton" class="nav-btn pomodoro-btn" onclick="togglePomodoro()" style="display: none;">t('navigation.startPomodoro')</button>
                    <div id="burgerAnchor" class="burger-anchor"></div>
                </div>
            </div>
        </div>
        
        <!-- Burger Menu positioned outside header to avoid clipping -->
        <div class="burger-menu">
            <button class="burger-btn" onclick="toggleBurgerMenu()" title="t('navigation.settingsMenu')">
                <span class="burger-line"></span>
                <span class="burger-line"></span>
                <span class="burger-line"></span>
            </button>
            <div class="burger-dropdown" id="burgerDropdown" style="display: none;">
                <button class="burger-item" onclick="showSection('tracker', event); closeBurgerMenu()"><span class="burger-emoji">📝</span><span class="burger-text">t('navigation.burgerMenu.tracker')</span></button>
                <button class="burger-item" onclick="showSection('notes', event); closeBurgerMenu()"><span class="burger-emoji">📔</span><span class="burger-text">t('navigation.burgerMenu.notes')</span></button>
                <button class="burger-item" onclick="showSection('todo', event); closeBurgerMenu()"><span class="burger-emoji">✅</span><span class="burger-text">t('navigation.burgerMenu.todo')</span></button>
                <div class="burger-separator"></div>
                <button class="burger-item" onclick="showSection('reports', event); closeBurgerMenu()"><span class="burger-emoji">📊</span><span class="burger-text">t('navigation.burgerMenu.reports')</span></button>
                <div class="burger-separator"></div>  
                <button class="burger-item" onclick="openWorkspaceManager(); closeBurgerMenu()"><span class="burger-emoji">🏢</span><span class="burger-text">t('navigation.burgerMenu.workspaces')</span></button>
                <div class="burger-separator"></div>
                <button class="burger-item" onclick="showSection('settings', event); closeBurgerMenu()"><span class="burger-emoji">⚙️</span><span class="burger-text">t('navigation.burgerMenu.settings')</span></button>
                <button class="burger-item" onclick="showSection('diagnostics', event); closeBurgerMenu()"><span class="burger-emoji">🔧</span><span class="burger-text">t('navigation.burgerMenu.diagnostics')</span></button>
                <div class="burger-separator"></div>
                <button class="burger-item" onclick="showLanguagePicker(); closeBurgerMenu()"><span class="burger-emoji">🌐</span><span class="burger-text">t('navigation.burgerMenu.language')</span></button>
                <button class="burger-item" onclick="showUserGuide(); closeBurgerMenu()"><span class="burger-emoji">📖</span><span class="burger-text">t('navigation.burgerMenu.userGuide')</span></button>
                <button class="burger-item" onclick="showAbout(); closeBurgerMenu()"><span class="burger-emoji">ℹ️</span><span class="burger-text">t('navigation.burgerMenu.about')</span></button>
            </div>
        </div>

        <!-- Status Banner -->
        <div id="statusBanner" class="status-banner" style="display: none;">
            <div class="status-banner-content">
                <!-- Pomodoro Status -->
                <div id="pomodoroStatusSection" class="status-section" style="display: none;">
                    <div class="pomodoro-bar">
                        <div id="pomodoroStatus" class="status-label">t('status.pomodoroDisabled')</div>
                        <div id="pomodoroTimer" class="pomodoro-active-bar" style="display: none;">
                            <div class="pomodoro-tomato">🍅</div>
                            <div id="pomodoroPhase" class="session-number">#1</div>
                            <div id="pomodoroTimeRemaining" class="countdown-timer">25:00</div>
                            <div id="pomodoroActivityDisplay" class="work-item" style="display: none;">
                                <div id="pomodoroActivityText" class="work-title"></div>
                                <div id="pomodoroActivityDesc" class="work-desc"></div>
                            </div>
                        </div>
                    </div>
                    <div id="pomodoroBannerControls" class="status-controls" style="display: none;">
                        <button id="pomodoroPauseBtn" class="status-button" onclick="togglePomodoroPause()">t('status.pause')</button>
                    </div>
                </div>
                
                <!-- Reminder Status -->
                <div id="reminderStatusSection" class="status-section" style="display: none;">
                    <div class="status-info">
                        <div id="reminderStatus" class="status-label">t('status.nextReminder')</div>
                        <div id="reminderTimer" class="status-timer">
                            <span id="reminderTimeRemaining">--:--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tracker Section -->
        <div id="tracker" class="section active">
            <!-- Activity Entry Component -->
            <div class="activity-entry-component" id="trackerEntryComponent">
                <div class="entry-header">
                    <h2 id="entryTitle">t('tracker.title')</h2>
                    <button class="entry-toggle-btn" id="trackerToggleBtn" onclick="toggleEntryForm('tracker')" title="t('tracker.hideShowForm')">
                        <span class="toggle-icon">📝</span>
                    </button>
                </div>
                <form id="activityForm">
                    <div class="form-group">
                        <label for="activity" id="activityLabel">t('tracker.activityLabel')</label>
                        <input type="text" id="activity" required placeholder="t('tracker.activityPlaceholder')" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="description" id="descriptionLabel">t('tracker.descriptionLabel')</label>
                        <textarea id="description" rows="3" placeholder="t('tracker.descriptionPlaceholder')"></textarea>
                    </div>
                    <div class="form-group form-group-row">
                        <div class="form-group">
                            <label for="timestamp">t('tracker.timeLabel')</label>
                            <input type="datetime-local" id="timestamp" required>
                            <div class="todo-quick-set">
                                <button type="button" class="btn-quick-set" id="todoToggleBtn" onclick="toggleTodoMode()" title="t('tracker.markTodoTitle')">t('tracker.markTodo')</button>
                                <button type="button" class="btn-quick-set" id="noteToggleBtn" onclick="toggleNoteMode()" title="t('tracker.markNoteTitle')">t('tracker.markNote')</button>
                            </div>
                        </div>
                        <div class="form-group" id="dueDateSection">
                            <label for="dueDate">t('tracker.dueDateLabel')</label>
                            <input type="datetime-local" id="dueDate">
                            <div class="due-date-quick-sets">
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('dueDate', -1, 'day')">t('tracker.dueDateQuickButtons.minus1d')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('dueDate', 1, 'day')">t('tracker.dueDateQuickButtons.plus1d')</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('dueDate', -1, 'week')">t('tracker.dueDateQuickButtons.minus1w')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('dueDate', 1, 'week')">t('tracker.dueDateQuickButtons.plus1w')</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('dueDate', -1, 'month')">t('tracker.dueDateQuickButtons.minus1m')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('dueDate', 1, 'month')">t('tracker.dueDateQuickButtons.plus1m')</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions-split">
                        <button type="submit" class="btn btn-primary" id="addEntryBtn">t('tracker.addEntry')</button>
                        <button type="button" class="btn btn-secondary" onclick="resetActivityForm()">t('tracker.reset')</button>
                    </div>
                </form>
                
                <div class="section-separator"></div>
            </div>

            <div class="entries-list">
                <h3>t('tracker.recentEntries')</h3>
                <div id="entriesList"></div>
                <div class="entries-pagination" id="entriesPagination" style="display: none;">
                    <button class="nav-btn" id="entriesPrevBtn" onclick="tracker.previousEntriesPage()">t('tracker.previous')</button>
                    <span id="entriesPageInfo"></span>
                    <button class="nav-btn" id="entriesNextBtn" onclick="tracker.nextEntriesPage()">t('tracker.next')</button>
                </div>
            </div>
        </div>

        <!-- To Do Section -->
        <div id="todo" class="section">
            <!-- Activity Entry Component -->
            <div class="activity-entry-component" id="todoEntryComponent">
                <div class="entry-header">
                    <h2 id="todoEntryTitle">t('todo.newTodo')</h2>
                    <button class="entry-toggle-btn" id="todoToggleBtn2" onclick="toggleEntryForm('todo')" title="t('tracker.hideShowForm')">
                        <span class="toggle-icon">✅</span>
                    </button>
                </div>
                <form id="todoActivityForm">
                    <div class="form-group">
                        <label for="todoActivity" id="todoActivityLabel">t('todo.todoLabel')</label>
                        <input type="text" id="todoActivity" required placeholder="t('todo.todoPlaceholder')" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="todoDescription" id="todoDescriptionLabel">t('todo.descriptionLabel')</label>
                        <textarea id="todoDescription" rows="3" placeholder="t('todo.descriptionPlaceholder')"></textarea>
                    </div>
                    <div class="form-group form-group-row">
                        <div class="form-group">
                            <label for="todoTimestamp">t('tracker.timeLabel')</label>
                            <input type="datetime-local" id="todoTimestamp" required>
                            <div class="todo-quick-set">
                                <button type="button" class="btn-quick-set active" id="todoTodoToggleBtn" onclick="toggleTodoModeForTodo()" title="t('todo.markTodoTitle')">t('tracker.markTodo')</button>
                                <button type="button" class="btn-quick-set" id="todoNoteToggleBtn" onclick="toggleNoteModeForTodo()" title="t('todo.markNoteTitle')">t('tracker.markNote')</button>
                            </div>
                        </div>
                        <div class="form-group" id="todoDueDateSection">
                            <label for="todoDueDate">t('tracker.dueDateLabel')</label>
                            <input type="datetime-local" id="todoDueDate">
                            <div class="due-date-quick-sets">
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('todoDueDate', -1, 'day')">t('tracker.dueDateQuickButtons.minus1d')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('todoDueDate', 1, 'day')">t('tracker.dueDateQuickButtons.plus1d')</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('todoDueDate', -1, 'week')">t('tracker.dueDateQuickButtons.minus1w')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('todoDueDate', 1, 'week')">t('tracker.dueDateQuickButtons.plus1w')</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('todoDueDate', -1, 'month')">t('tracker.dueDateQuickButtons.minus1m')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('todoDueDate', 1, 'month')">t('tracker.dueDateQuickButtons.plus1m')</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions-split">
                        <button type="submit" class="btn btn-primary" id="todoAddEntryBtn">t('todo.addTodo')</button>
                        <button type="button" class="btn btn-secondary" onclick="resetTodoForm()">t('tracker.reset')</button>
                    </div>
                </form>
                
                <div class="section-separator"></div>
            </div>

            <h3>t('todo.todoList')</h3>
            <div class="todo-filters">
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="todoFilter">t('todo.filter')</label>
                        <select id="todoFilter" onchange="tracker.filterTodos()">
                            <option value="all">t('todo.filters.allTodos')</option>
                            <option value="due-today">t('todo.filters.dueToday')</option>
                            <option value="overdue">t('todo.filters.overdue')</option>
                            <option value="no-due-date">t('todo.filters.noDueDate')</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="todoSort">t('todo.sortBy')</label>
                        <select id="todoSort" onchange="tracker.sortTodos()">
                            <option value="created-desc">t('todo.sorting.newestFirst')</option>
                            <option value="created-asc">t('todo.sorting.oldestFirst')</option>
                            <option value="due-asc">t('todo.sorting.dueDateEarliest')</option>
                            <option value="due-desc">t('todo.sorting.dueDateLatest')</option>
                            <option value="activity-asc">t('todo.sorting.activityAZ')</option>
                            <option value="activity-desc">t('todo.sorting.activityZA')</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="todo-stats" id="todoStats">
                <span id="todoCount">t('todo.todoCount', {count: 0})</span>
            </div>

            <div class="todo-list" id="todoList">
                <p class="empty-state">t('todo.noTodos')</p>
            </div>

            <div class="todo-pagination" id="todoPagination" style="display: none;">
                <button class="nav-btn" id="todoPrevBtn" onclick="tracker.previousTodoPage()">t('todo.pagination.previous')</button>
                <span id="todoPageInfo">t('todo.pagination.pageInfo', {current: 1, total: 1})</span>
                <button class="nav-btn" id="todoNextBtn" onclick="tracker.nextTodoPage()">t('todo.pagination.next')</button>
            </div>
        </div>

        <!-- Notes Section -->
        <div id="notes" class="section">
            <!-- Activity Entry Component -->
            <div class="activity-entry-component" id="notesEntryComponent">
                <div class="entry-header">
                    <h2 id="notesEntryTitle">t('notes.newNote')</h2>
                    <button class="entry-toggle-btn" id="notesToggleBtn2" onclick="toggleEntryForm('notes')" title="t('tracker.hideShowForm')">
                        <span class="toggle-icon">📔</span>
                    </button>
                </div>
                <form id="notesActivityForm">
                    <div class="form-group">
                        <label for="notesActivity" id="notesActivityLabel">t('notes.titleLabel')</label>
                        <input type="text" id="notesActivity" required placeholder="t('notes.titlePlaceholder')" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="notesDescription" id="notesDescriptionLabel">t('notes.contentLabel')</label>
                        <textarea id="notesDescription" rows="3" placeholder="t('notes.contentPlaceholder')"></textarea>
                    </div>
                    <div class="form-group form-group-row">
                        <div class="form-group">
                            <label for="notesTimestamp">t('tracker.timeLabel')</label>
                            <input type="datetime-local" id="notesTimestamp" required>
                            <div class="todo-quick-set">
                                <button type="button" class="btn-quick-set" id="notesTodToggleBtn" onclick="toggleTodoModeForNotes()" title="t('tracker.markTodoTitle')">t('tracker.markTodo')</button>
                                <button type="button" class="btn-quick-set active" id="notesNoteToggleBtn" onclick="toggleNoteModeForNotes()" title="t('tracker.markNoteTitle')">t('tracker.markNote')</button>
                            </div>
                        </div>
                        <div class="form-group" id="notesDueDateSection" style="display: none;">
                            <label for="notesDueDate">t('tracker.dueDateLabel')</label>
                            <input type="datetime-local" id="notesDueDate">
                            <div class="due-date-quick-sets">
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('notesDueDate', -1, 'day')">t('tracker.dueDateQuickButtons.minus1d')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('notesDueDate', 1, 'day')">t('tracker.dueDateQuickButtons.plus1d')</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('notesDueDate', -1, 'week')">t('tracker.dueDateQuickButtons.minus1w')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('notesDueDate', 1, 'week')">t('tracker.dueDateQuickButtons.plus1w')</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('notesDueDate', -1, 'month')">t('tracker.dueDateQuickButtons.minus1m')</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('notesDueDate', 1, 'month')">t('tracker.dueDateQuickButtons.plus1m')</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-actions-split">
                        <button type="submit" class="btn btn-primary" id="notesAddEntryBtn">t('notes.addNote')</button>
                        <button type="button" class="btn btn-secondary" onclick="resetNotesForm()">t('tracker.reset')</button>
                    </div>
                </form>
                
                <div class="section-separator"></div>
            </div>

            <h3>t('notes.notesTitle')</h3>
            <div class="notes-filters">
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="noteFilter">t('todo.filter')</label>
                        <select id="noteFilter" onchange="tracker.filterNotes()">
                            <option value="all">t('notes.filters.allNotes')</option>
                            <option value="today">t('notes.filters.today')</option>
                            <option value="week">t('notes.filters.thisWeek')</option>
                            <option value="month">t('notes.filters.thisMonth')</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="noteSort">t('notes.sort')</label>
                        <select id="noteSort" onchange="tracker.sortNotes()">
                            <option value="newest">t('notes.sorting.newestFirst')</option>
                            <option value="oldest">t('notes.sorting.oldestFirst')</option>
                            <option value="activity">t('notes.sorting.activityName')</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <input type="text" id="noteSearchInput" placeholder="t('notes.searchPlaceholder')" onkeyup="tracker.searchNotes()" oninput="tracker.toggleNoteClearButton()" autocomplete="off">
                        <button class="btn btn-secondary btn-small" id="noteClearBtn" onclick="tracker.clearNoteSearch()" style="display: none;">t('notes.clear')</button>
                    </div>
                </div>
            </div>
            
            <div id="noteList" class="entry-list">
                <p class="no-entries">t('notes.noNotes')</p>
            </div>
            
            <div class="notes-pagination" id="notesPagination" style="display: none;">
                <button class="nav-btn" id="notesPrevBtn" onclick="tracker.previousNotePage()">t('todo.pagination.previous')</button>
                <span id="notesPageInfo">t('todo.pagination.pageInfo', {current: 1, total: 1})</span>
                <button class="nav-btn" id="notesNextBtn" onclick="tracker.nextNotePage()">t('todo.pagination.next')</button>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports" class="section">
            <h2>t('reports.title')</h2>

            <!-- Report Generation -->
            <div class="reports-grid">
                <div class="reports-section">
                    <h3>t('reports.dateRange')</h3>
                    <p class="settings-description">t('reports.dateRangeDescription')</p>
                    <div class="form-group">
                        <label for="reportStartDate" title="t('reports.startDateTitle')">t('reports.startDateLabel')</label>
                        <input type="date" id="reportStartDate">
                    </div>
                    <div class="form-group">
                        <label for="reportEndDate" title="t('reports.endDateTitle')">t('reports.endDateLabel')</label>
                        <input type="date" id="reportEndDate">
                    </div>
                    <div class="report-actions">
                        <button class="btn btn-primary" onclick="generateReport()" title="t('reports.generateReportTitle')">t('reports.generateReport')</button>
                        <button class="btn btn-secondary" onclick="setWeeklyReport()" title="t('reports.thisWeekTitle')">t('reports.thisWeek')</button>
                    </div>
                </div>

                <div class="reports-section">
                    <h3>t('reports.templateOptions')</h3>
                    <p class="settings-description">t('reports.templateOptionsDescription')</p>
                    <div class="form-group">
                        <label for="reportTemplate" title="t('reports.reportTemplateTitle')">t('reports.reportTemplateLabel')</label>
                        <select id="reportTemplate" onchange="tracker.previewReport()"></select>
                    </div>
                    <div class="form-group">
                        <label for="includeTodos">t('reports.todoItems')</label>
                        <select id="includeTodos" onchange="tracker.generateReport()">
                            <option value="exclude">t('reports.todoOptions.excludeAll')</option>
                            <option value="incomplete">t('reports.todoOptions.incompleteOnly')</option>
                            <option value="all">t('reports.todoOptions.includeAll')</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="includeNotes">t('reports.notes')</label>
                        <select id="includeNotes" onchange="tracker.generateReport()">
                            <option value="exclude">t('reports.noteOptions.exclude')</option>
                            <option value="include">t('reports.noteOptions.include')</option>
                        </select>
                    </div>
                    <div class="download-actions">
                        <button class="btn btn-success" onclick="downloadReport()" title="t('reports.downloadReportTitle')">t('reports.downloadReport')</button>
                        <button class="btn btn-primary" onclick="openReportInNewTab()" title="t('reports.openNewTabTitle')">t('reports.openNewTab')</button>
                    </div>
                </div>
            </div>

            <!-- Week Navigation -->
            <div class="report-navigation-section">
                <div class="report-navigation">
                    <button class="nav-btn" onclick="previousWeek()">t('reports.weekNavigation.previous')</button>
                    <div class="week-display" id="weekDisplay">t('reports.weekNavigation.weekOf', {date: '...'})</div>
                    <button class="nav-btn" onclick="nextWeek()">t('reports.weekNavigation.next')</button>
                </div>
            </div>

            <div id="reportPreviewContainer" class="report-preview-container">
                <div class="report-preview-header">
                    <h3>t('reports.reportPreview')</h3>
                    <div class="preview-controls">
                        <div class="preview-format-tabs">
                            <button class="preview-tab active" id="reportPreviewTabRendered" onclick="switchReportPreviewTab('rendered')" title="t('reports.viewFormattedTitle')">t('reports.rendered')</button>
                            <button class="preview-tab" id="reportPreviewTabSource" onclick="switchReportPreviewTab('source')" title="t('reports.viewSourceTitle')">t('reports.source')</button>
                        </div>
                        <button class="btn-copy-report" id="copyReportBtn" onclick="copyReportToClipboard()" title="t('reports.copyReportTitle')" style="display: none;">t('reports.copyReport')</button>
                    </div>
                </div>
                <div id="reportPreview" class="report-preview-content">
                    t('reports.selectDateRange')
                </div>
            </div>
            
            <!-- Report Templates Management -->
            <div class="report-templates-section">
                <div class="settings-card">
                    <h3>t('reports.reportTemplates')</h3>
                    <p class="card-description">t('reports.templatesDescription')</p>
                    <div class="card-actions">
                        <button class="btn btn-primary" onclick="openTemplateManager()" title="t('reports.manageTemplatesTitle')">t('reports.manageTemplates')</button>
                        <button class="btn btn-secondary" onclick="resetReportTemplates()" title="t('reports.resetDefaultTitle')">t('reports.resetDefault')</button>
                        <button class="btn btn-info" onclick="showTemplateGuide()" title="t('reports.templateGuideTitle')">t('reports.templateGuide')</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings" class="section">
            <h2>t('settings.title')</h2>
            
            <div class="notification-status" id="notificationStatus">
                <span class="status-indicator" id="statusIndicator"></span>
                <span id="statusText">Checking notification status...</span>
            </div>

            <!-- Reminder Control Buttons -->
            <div class="settings-buttons-section">
                <div class="reminder-buttons">
                    <button class="btn btn-primary" onclick="enableNotifications()">t('settings.enableReminders')</button>
                </div>
            </div>

            <!-- General Settings (Shared between all modes) -->
            <div class="settings-section general-settings">
                <h3>t('settings.generalSettings')</h3>
                <p class="settings-description">t('settings.generalDescription')</p>
                <div class="settings-grid settings-grid-four-col">
                    <div class="form-group">
                        <label for="darkModePreference" title="t('settings.colourThemeTitle')">t('settings.colourTheme')</label>
                        <select id="darkModePreference" onchange="saveSettings()">
                            <option value="system">t('settings.themeOptions.system')</option>
                            <option value="light">t('settings.themeOptions.light')</option>
                            <option value="dark">t('settings.themeOptions.dark')</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="soundMuteMode" title="t('settings.soundSettingsTitle')">t('settings.soundSettings')</label>
                        <select id="soundMuteMode" onchange="saveSettings()">
                            <option value="none">t('settings.soundOptions.allEnabled')</option>
                            <option value="all">t('settings.soundOptions.muteAll')</option>
                            <option value="pomodoro">t('settings.soundOptions.mutePomodoroOnly')</option>
                            <option value="notifications">t('settings.soundOptions.muteNotificationOnly')</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="paginationSize" title="t('settings.itemsPerPageTitle')">t('settings.itemsPerPage')</label>
                        <select id="paginationSize" onchange="saveSettings()">
                            <option value="10">t('settings.itemsPerPageOptions.10')</option>
                            <option value="20" selected>t('settings.itemsPerPageOptions.20')</option>
                            <option value="30">t('settings.itemsPerPageOptions.30')</option>
                            <option value="50">t('settings.itemsPerPageOptions.50')</option>
                            <option value="100">t('settings.itemsPerPageOptions.100')</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dateFormat" title="t('settings.dateFormatTitle')">t('settings.dateFormat')</label>
                        <select id="dateFormat" onchange="saveSettings()">
                            <option value="default">t('settings.dateFormatOptions.default')</option>
                            <option value="iso">t('settings.dateFormatOptions.iso')</option>
                            <option value="us">t('settings.dateFormatOptions.us')</option>
                            <option value="european">t('settings.dateFormatOptions.european')</option>
                            <option value="short">t('settings.dateFormatOptions.short')</option>
                            <option value="long">t('settings.dateFormatOptions.long')</option>
                        </select>
                    </div>
                    <div class="form-group" id="systemNotificationsGroup" style="display: none;">
                        <label for="sendSystemNotifications" title="t('settings.systemNotificationsTitle')">t('settings.systemNotifications')</label>
                        <select id="sendSystemNotifications" onchange="saveSettings()">
                            <option value="true" selected>Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Main Settings Grid -->
            <div class="settings-grid settings-grid-two-col">
                <div class="settings-section">
                    <h3>t('settings.reminderSettings')</h3>
                    <div class="form-group">
                        <label for="notificationInterval" title="t('settings.reminderIntervalTitle')">t('settings.reminderInterval')</label>
                        <select id="notificationInterval" onchange="saveSettings()">
                            <option value="1">1 minute</option>
                            <option value="2">2 minutes</option>
                            <option value="5">5 minutes</option>
                            <option value="15">15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="60" selected>1 hour</option>
                            <option value="90">1.5 hours</option>
                            <option value="120">2 hours</option>
                            <option value="180">3 hours</option>
                            <option value="240">4 hours</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pauseDuration" title="t('settings.pauseResumeTitle')">t('settings.pauseResume')</label>
                        <select id="pauseDuration" onchange="saveSettings()">
                            <option value="1">1 minute</option>
                            <option value="2">2 minutes</option>
                            <option value="5">5 minutes</option>
                            <option value="15">15 minutes</option>
                            <option value="30">30 minutes</option>
                            <option value="60">1 hour</option>
                            <option value="90">1.5 hours</option>
                            <option value="120">2 hours</option>
                            <option value="180">3 hours</option>
                            <option value="240">4 hours</option>
                            <option value="480">8 hours</option>
                            <option value="1440">24 hours</option>
                            <option value="-1">Never</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="autoStartAlerts" title="t('settings.autoStartTitle')">t('settings.autoStart')</label>
                        <select id="autoStartAlerts" onchange="saveSettings()">
                            <option value="false" selected>No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notificationSoundType" title="t('settings.reminderSoundTitle')">t('settings.reminderSound')</label>
                        <select id="notificationSoundType" onchange="previewNotificationSound()">
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>t('schedule.title')</h3>
                    <p class="settings-description">Set your active activity hours and days for notifications</p>
                    
                    <div class="schedule-section">
                        <div class="schedule-header">
                            <h4>t('schedule.activityHours')</h4>
                            <div class="schedule-mode-toggle">
                                <div class="checkbox-group inline">
                                    <input type="checkbox" id="useComplexSchedule" onchange="toggleScheduleMode()">
                                    <label for="useComplexSchedule" title="t('schedule.complexScheduleTitle')">t('schedule.complexSchedule')</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Simple Schedule (default) -->
                        <div id="simpleSchedule" class="schedule-mode">
                            <div class="time-inputs">
                                <div class="form-group">
                                    <label for="startTime" title="t('schedule.startTimeTitle')">t('schedule.startTime')</label>
                                    <input type="time" id="startTime" value="08:00" onchange="saveSettings()">
                                </div>
                                <div class="form-group">
                                    <label for="endTime" title="t('schedule.endTimeTitle')">t('schedule.endTime')</label>
                                    <input type="time" id="endTime" value="18:00" onchange="saveSettings()">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Complex Schedule -->
                        <div id="complexSchedule" class="schedule-mode" style="display: none;">
                            <p class="settings-description">Set multiple time ranges for each day to accommodate complex schedules.</p>
                            <div class="complex-schedule-container">
                                <div class="day-schedule" data-day="monday">
                                    <h5>Monday</h5>
                                    <div class="time-ranges" id="monday-ranges"></div>
                                    <button type="button" class="btn btn-small" onclick="addTimeRange('monday')">t('schedule.addRange')</button>
                                </div>
                                <div class="day-schedule" data-day="tuesday">
                                    <h5>Tuesday</h5>
                                    <div class="time-ranges" id="tuesday-ranges"></div>
                                    <button type="button" class="btn btn-small" onclick="addTimeRange('tuesday')">t('schedule.addRange')</button>
                                </div>
                                <div class="day-schedule" data-day="wednesday">
                                    <h5>Wednesday</h5>
                                    <div class="time-ranges" id="wednesday-ranges"></div>
                                    <button type="button" class="btn btn-small" onclick="addTimeRange('wednesday')">t('schedule.addRange')</button>
                                </div>
                                <div class="day-schedule" data-day="thursday">
                                    <h5>Thursday</h5>
                                    <div class="time-ranges" id="thursday-ranges"></div>
                                    <button type="button" class="btn btn-small" onclick="addTimeRange('thursday')">t('schedule.addRange')</button>
                                </div>
                                <div class="day-schedule" data-day="friday">
                                    <h5>Friday</h5>
                                    <div class="time-ranges" id="friday-ranges"></div>
                                    <button type="button" class="btn btn-small" onclick="addTimeRange('friday')">t('schedule.addRange')</button>
                                </div>
                                <div class="day-schedule" data-day="saturday">
                                    <h5>Saturday</h5>
                                    <div class="time-ranges" id="saturday-ranges"></div>
                                    <button type="button" class="btn btn-small" onclick="addTimeRange('saturday')">t('schedule.addRange')</button>
                                </div>
                                <div class="day-schedule" data-day="sunday">
                                    <h5>Sunday</h5>
                                    <div class="time-ranges" id="sunday-ranges"></div>
                                    <button type="button" class="btn btn-small" onclick="addTimeRange('sunday')">t('schedule.addRange')</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="schedule-section">
                        <h4>t('schedule.activityDays')</h4>
                        <div class="activity-days-grid">
                            <div class="checkbox-group">
                                <input type="checkbox" id="monday" checked onchange="saveSettings()">
                                <label for="monday">Monday</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="tuesday" checked onchange="saveSettings()">
                                <label for="tuesday">Tuesday</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="wednesday" checked onchange="saveSettings()">
                                <label for="wednesday">Wednesday</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="thursday" checked onchange="saveSettings()">
                                <label for="thursday">Thursday</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="friday" checked onchange="saveSettings()">
                                <label for="friday">Friday</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="saturday" onchange="saveSettings()">
                                <label for="saturday">Saturday</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="checkbox" id="sunday" onchange="saveSettings()">
                                <label for="sunday">Sunday</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pomodoro Mode Section -->
            <div class="pomodoro-section">
                <div class="settings-card">
                    <h3>Pomodoro Mode</h3>
                    <p class="card-description">Structured work/break intervals with automatic notifications</p>
                    <div class="pomodoro-settings">
                        <div class="checkbox-group">
                            <input type="checkbox" id="pomodoroEnabled" onchange="saveSettings()">
                            <label for="pomodoroEnabled" title="t('pomodoro.enableTitle')">t('pomodoro.enable')</label>
                        </div>
                        
                        <div class="pomodoro-config" id="pomodoroConfig" style="display: none;">
                            
                            <!-- Timer Configuration -->
                            <div class="pomodoro-timers">
                                <div class="form-group">
                                    <label for="pomodoroWorkDuration" title="t('pomodoro.workDurationTitle')">t('pomodoro.workDuration')</label>
                                    <select id="pomodoroWorkDuration" onchange="saveSettings()">
                                        <option value="15">15 minutes</option>
                                        <option value="20">20 minutes</option>
                                        <option value="25" selected>25 minutes</option>
                                        <option value="30">30 minutes</option>
                                        <option value="45">45 minutes</option>
                                        <option value="60">60 minutes</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pomodoroBreakDuration" title="t('pomodoro.shortBreakTitle')">t('pomodoro.shortBreak')</label>
                                    <select id="pomodoroBreakDuration" onchange="saveSettings()">
                                        <option value="3">3 minutes</option>
                                        <option value="5" selected>5 minutes</option>
                                        <option value="10">10 minutes</option>
                                        <option value="15">15 minutes</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pomodoroLongBreakDuration" title="t('pomodoro.longBreakTitle')">t('pomodoro.longBreak')</label>
                                    <select id="pomodoroLongBreakDuration" onchange="saveSettings()">
                                        <option value="15" selected>15 minutes</option>
                                        <option value="20">20 minutes</option>
                                        <option value="30">30 minutes</option>
                                        <option value="45">45 minutes</option>
                                        <option value="60">60 minutes</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pomodoroLongBreakInterval" title="t('pomodoro.sessionsBeforeLongTitle')">t('pomodoro.sessionsBeforeLong')</label>
                                    <select id="pomodoroLongBreakInterval" onchange="saveSettings()">
                                        <option value="2">Every 2 sessions</option>
                                        <option value="3">Every 3 sessions</option>
                                        <option value="4" selected>Every 4 sessions</option>
                                        <option value="5">Every 5 sessions</option>
                                        <option value="6">Every 6 sessions</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Tick Sound Configuration -->
                            <div class="pomodoro-sounds">
                                <h4>Tick Sounds</h4>
                                <div class="form-group">
                                    <label for="pomodoroTickSound" title="t('pomodoro.tickSoundTitle')">t('pomodoro.tickSoundType')</label>
                                    <select id="pomodoroTickSound" onchange="saveSettings()">
                                        <option value="none" selected>No ticking</option>
                                        <option value="soft">Soft tick</option>
                                        <option value="classic">Classic tick</option>
                                        <option value="digital">Digital tick</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pomodoroTickInterval" title="t('pomodoro.tickIntervalTitle')">t('pomodoro.tickInterval')</label>
                                    <select id="pomodoroTickInterval" onchange="saveSettings()">
                                        <option value="0" selected>Off (no ticking)</option>
                                        <option value="1">Every 1 second</option>
                                        <option value="2">Every 2 seconds</option>
                                        <option value="3">Every 3 seconds</option>
                                        <option value="4">Every 4 seconds</option>
                                        <option value="5">Every 5 seconds</option>
                                        <option value="10">Every 10 seconds</option>
                                        <option value="15">Every 15 seconds</option>
                                        <option value="30">Every 30 seconds</option>
                                        <option value="60">Every minute</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Announce Sound Configuration -->
                            <div class="pomodoro-announce-sounds">
                                <h4>Announce Sounds</h4>
                                <div class="form-group">
                                    <label for="pomodoroShortBreakSound" title="t('pomodoro.shortBreakAnnounceTitle')">t('pomodoro.shortBreakAnnounce')</label>
                                    <select id="pomodoroShortBreakSound" onchange="saveSettings()">
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pomodoroLongBreakSound" title="t('pomodoro.longBreakAnnounceTitle')">t('pomodoro.longBreakAnnounce')</label>
                                    <select id="pomodoroLongBreakSound" onchange="saveSettings()">
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="pomodoroResumeSound" title="t('pomodoro.resumeWorkAnnounceTitle')">t('pomodoro.resumeWorkAnnounce')</label>
                                    <select id="pomodoroResumeSound" onchange="saveSettings()">
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Pomodoro Options -->
                            <div class="pomodoro-options">
                                <h4>Options</h4>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pomodoroAutoStart" onchange="saveSettings()">
                                    <label for="pomodoroAutoStart" title="t('pomodoro.autoStartTitle')">t('pomodoro.autoStart')</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pomodoroAutoLog" checked onchange="saveSettings()">
                                    <label for="pomodoroAutoLog" title="t('pomodoro.promptDescriptionsTitle')">t('pomodoro.promptDescriptions')</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pomodoroLogBreaks" onchange="saveSettings()">
                                    <label for="pomodoroLogBreaks" title="t('pomodoro.logBreaksTitle')">t('pomodoro.logBreaks')</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pomodoroLongBreak" checked onchange="saveSettings()">
                                    <label for="pomodoroLongBreak" title="t('pomodoro.enableLongBreaksTitle')">t('pomodoro.enableLongBreaks')</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pomodoroPauseAllowed" checked onchange="saveSettings()">
                                    <label for="pomodoroPauseAllowed" title="t('pomodoro.allowPausingTitle')">t('pomodoro.allowPausing')</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pomodoroAutoResetDaily" onchange="saveSettings()">
                                    <label for="pomodoroAutoResetDaily" title="t('pomodoro.autoResetDailyTitle')">t('pomodoro.autoResetDaily')</label>
                                </div>
                            </div>
                            
                            <!-- Session Management -->
                            <div class="pomodoro-session-management">
                                <h5>Session Management</h5>
                                <div class="session-actions">
                                    <button type="button" class="btn btn-outline btn-warning" onclick="resetPomodoroSessions()" title="t('pomodoro.resetCounterTitle')">
                                        Reset Session Counter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Management Section -->
            <div class="data-management-section">
                <div class="data-management-grid">
                    <div class="settings-card">
                        <h3>Database Backup</h3>
                        <p class="card-description">Export or import your activity data</p>
                        <div class="card-actions">
                            <button class="btn btn-primary" onclick="exportDatabase()">Export Database</button>
                            <button class="btn btn-secondary" onclick="importDatabase()">Import Database</button>
                            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImportFile(event)">
                        </div>
                    </div>
                    
                    <div class="settings-card">
                        <h3>Warning Settings</h3>
                        <p class="card-description">Configure confirmation dialogs for destructive actions</p>
                        <div class="warning-settings">
                            <div class="form-group">
                                <label for="warnOnActivityDelete" title="t('dataManagement.warnDeleteTitle')">t('dataManagement.warnDelete')</label>
                                <select id="warnOnActivityDelete" onchange="saveSettings()">
                                    <option value="true" selected>Yes</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="warnOnSessionReset" title="t('dataManagement.warnResetTitle')">t('dataManagement.warnReset')</label>
                                <select id="warnOnSessionReset" onchange="saveSettings()">
                                    <option value="true" selected>Yes</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <button class="btn btn-primary" onclick="saveSettings()">Force Manual Save</button>
        </div>

        <!-- Diagnostics Section -->
        <div id="diagnostics" class="section">
            <h2>🔧 Diagnostics</h2>
            
            <div class="diagnostics-container">
                <div class="settings-section">
                    <h3>System Tests</h3>
                    <p class="settings-description">Test various system components and functionality</p>
                    <div class="diagnostic-grid">
                        <div class="diagnostic-card">
                            <h4>🔔 Notifications</h4>
                            <div class="diagnostic-buttons">
                                <button class="btn btn-secondary diagnostic-btn" onclick="testNotification()" title="t('diagnostics.testReminderTitle')">
                                    <span class="btn-icon">🧪</span>Test Reminder
                                </button>
                                <button class="btn btn-primary diagnostic-btn" onclick="testNotificationSound()" title="t('diagnostics.testSoundTitle')">
                                    <span class="btn-icon">🔊</span>Test Sound
                                </button>
                                <button class="btn btn-secondary diagnostic-btn" onclick="refreshNotificationStatus()" title="t('diagnostics.refreshStatusTitle')">
                                    <span class="btn-icon">🔄</span>Refresh Status
                                </button>
                                <button class="btn btn-warning diagnostic-btn" onclick="forceEnableNotifications()" title="t('diagnostics.forceEnableTitle')">
                                    <span class="btn-icon">⚡</span>Force Enable
                                </button>
                            </div>
                        </div>
                        
                        <div class="diagnostic-card">
                            <h4>⚙️ Service Worker</h4>
                            <div class="diagnostic-buttons">
                                <button class="btn btn-secondary diagnostic-btn" onclick="runServiceWorkerTest()" title="t('diagnostics.runDiagnosticsTitle')">
                                    <span class="btn-icon">🔍</span>Run Diagnostics
                                </button>
                            </div>
                        </div>
                        
                        <div class="diagnostic-card dangerous">
                            <h4>⚠️ Data Management</h4>
                            <p class="diagnostic-warning">These actions cannot be undone</p>
                            <div class="diagnostic-buttons">
                                <button class="btn btn-danger diagnostic-btn" onclick="clearAllData()">
                                    <span class="btn-icon">🗑️</span>Clear All Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Results Section -->
        <div id="search" class="section">
            <h2>Search Results</h2>
            
            <div class="search-controls">
                <div class="search-info" id="searchInfo">
                    <span id="searchQuery"></span>
                    <span id="searchCount">0 results</span>
                </div>
                
                <div class="search-options">
                    <div class="filter-group">
                        <label for="searchSort">Sort by:</label>
                        <select id="searchSort" onchange="tracker.sortSearchResults()">
                            <option value="relevance">Relevance</option>
                            <option value="date-desc">Newest First</option>
                            <option value="date-asc">Oldest First</option>
                            <option value="activity-asc">t('search.filters.activityAZ')</option>
                            <option value="activity-desc">t('search.filters.activityZA')</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="searchFilter">Show:</label>
                        <select id="searchFilter" onchange="tracker.filterSearchResults()">
                            <option value="all">All Items</option>
                            <option value="activities">Activities Only</option>
                            <option value="todos">Todos Only</option>
                            <option value="completed">Completed Only</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="search-results-list" id="searchResultsList">
                <p class="empty-state">Use the search box above to find activities, todos, and hashtags.</p>
            </div>

            <div class="search-pagination" id="searchPagination" style="display: none;">
                <button class="nav-btn" id="searchPrevBtn" onclick="tracker.previousSearchPage()">t('todo.pagination.previous')</button>
                <span id="searchPageInfo">t('todo.pagination.pageInfo', {current: 1, total: 1})</span>
                <button class="nav-btn" id="searchNextBtn" onclick="tracker.nextSearchPage()">t('todo.pagination.next')</button>
            </div>
        </div>
    </div>

    <!-- Notification Stack Container -->
    <div id="notificationStack" class="notification-stack"></div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content edit-modal-content">
            <div class="modal-header">
                <h3>t('modals.edit.title')</h3>
                <button class="btn-close" onclick="closeEditModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <input type="hidden" id="editId">
                    <div class="form-group">
                        <label for="editActivity">t('modals.edit.activity')</label>
                        <input type="text" id="editActivity" required>
                    </div>
                    <div class="form-group">
                        <label for="editDescription">t('modals.edit.description')</label>
                        <textarea id="editDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group form-group-row">
                        <div class="form-group">
                            <label for="editTimestamp">t('modals.edit.time')</label>
                            <input type="datetime-local" id="editTimestamp" required>
                            <div class="todo-quick-set">
                                <button type="button" id="editTodoButton" class="btn-quick-set" onclick="toggleEditTodo()">
                                    <span id="editTodoButtonText">t('modals.edit.markTodo')</span>
                                </button>
                                <button type="button" id="editNoteButton" class="btn-quick-set" onclick="toggleEditNote()">
                                    <span id="editNoteButtonText">t('modals.edit.markNote')</span>
                                </button>
                            </div>
                        </div>
                        <div class="form-group" id="editDueDateSection">
                            <label for="editDueDate">t('modals.edit.dueDate')</label>
                            <input type="datetime-local" id="editDueDate">
                            <div class="due-date-quick-sets">
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('editDueDate', -1, 'day')">-1d</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('editDueDate', 1, 'day')">+1d</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('editDueDate', -1, 'week')">-1w</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('editDueDate', 1, 'week')">+1w</button>
                                </div>
                                <div class="due-date-group">
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('editDueDate', -1, 'month')">-1m</button>
                                    <button type="button" class="btn-quick-set" onclick="adjustDueDate('editDueDate', 1, 'month')">+1m</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="submit" class="btn btn-primary">t('modals.edit.update')</button>
                        <button type="button" class="btn btn-secondary" onclick="closeEditModal()">t('modals.edit.cancel')</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Template Management Overlay -->
    <div id="templateManagerOverlay" class="template-overlay">
        <div class="template-overlay-content">
            <div class="template-manager-header">
                <h2>Template Manager</h2>
                <div class="template-manager-actions">
                    <button class="btn btn-primary" onclick="saveAllTemplates()">Save All Changes</button>
                    <button class="btn btn-secondary" onclick="closeTemplateManager()">Close</button>
                </div>
            </div>
            
            <div class="template-manager-body">
                <div class="template-list-panel">
                    <h3>Templates</h3>
                    <div class="template-list" id="templateList">
                        <!-- Template list items will be added here -->
                    </div>
                    <div class="template-list-actions">
                        <button class="btn btn-primary" onclick="addNewTemplate()">Add Template</button>
                        <button class="btn btn-secondary" onclick="resetToDefaults()">Reset All</button>
                    </div>
                </div>
                
                <div class="template-editor-panel">
                    <div class="template-editor-header">
                        <h3 id="templateEditorTitle">t('modals.templateManager.selectTemplate')</h3>
                        <div class="template-editor-actions" id="templateEditorActions" style="display: none;">
                            <button class="btn btn-success" onclick="saveCurrentTemplate()">Save</button>
                            <button class="btn btn-danger" onclick="deleteCurrentTemplate()">t('modals.templateManager.delete')</button>
                            <button class="btn btn-secondary" onclick="duplicateCurrentTemplate()">Duplicate</button>
                        </div>
                    </div>
                    
                    <div class="template-editor-tabs" id="templateEditorTabs" style="display: none;">
                        <button class="template-tab active" id="tabEditor" onclick="switchTemplateTab('editor')">t('modals.templateManager.editor')</button>
                        <button class="template-tab" id="tabPreview" onclick="switchTemplateTab('preview')">t('modals.templateManager.preview')</button>
                    </div>
                    
                    <div class="template-editor-content">
                        <div class="template-editor-form" id="templateEditorForm" style="display: none;">
                            <div class="form-group">
                                <label for="templateName">Template Name</label>
                                <input type="text" id="templateName" placeholder="e.g., My Custom Template">
                            </div>
                            
                            <div class="form-group">
                                <label for="templateDescription">t('modals.templateManager.description')</label>
                                <input type="text" id="templateDescription" placeholder="t('modals.templateManager.descriptionPlaceholder')">
                            </div>
                            
                            <div class="form-group">
                                <label for="templateType">Output Type</label>
                                <select id="templateType">
                                    <option value="html">HTML</option>
                                    <option value="markdown">Markdown</option>
                                    <option value="csv">CSV</option>
                                    <option value="text">Plain Text</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="templateContent">Template Content</label>
                                <textarea id="templateContent" rows="20" placeholder="t('modals.templateManager.templateContentPlaceholder')"></textarea>
                            </div>
                            
                            <div class="checkbox-group">
                                <input type="checkbox" id="templateIsDefault">
                                <label for="templateIsDefault">Set as default template</label>
                            </div>
                        </div>
                        
                        <div class="template-preview-panel" id="templatePreviewPanel" style="display: none;">
                            <div class="template-preview-header">
                                <h4>Preview</h4>
                                <div class="template-preview-controls">
                                    <div class="preview-format-tabs">
                                        <button class="preview-tab active" id="previewTabRendered" onclick="switchPreviewTab('rendered')">Rendered</button>
                                        <button class="preview-tab" id="previewTabSource" onclick="switchPreviewTab('source')">Source</button>
                                    </div>
                                    <button class="btn btn-secondary btn-small" onclick="refreshTemplatePreview()">Refresh</button>
                                </div>
                            </div>
                            <div class="template-preview-content" id="templatePreviewContent">
                                <p class="template-preview-placeholder">Select a template to see preview</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <!-- Template Guide Modal -->
    <div id="templateGuideModal" class="modal">
        <div class="modal-content template-guide-content">
            <div class="modal-header">
                <h3>Template Guide</h3>
                <button class="btn-close" onclick="closeTemplateGuide()">&times;</button>
            </div>
            <div class="modal-body">
                {{TEMPLATE_GUIDE_CONTENT}}
            </div>
        </div>
    </div>

    <!-- Pomodoro Activity Modal -->
    <div id="pomodoroActivityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>t('modals.pomodoroActivity.title')</h3>
                <button class="btn-close" onclick="closePomodoroActivityModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="pomodoroActivityForm">
                    <div class="form-group">
                        <label for="pomodoroActivityName">t('modals.pomodoroActivity.activityLabel')</label>
                        <input type="text" id="pomodoroActivityName" required placeholder="t('modals.pomodoroActivity.activityPlaceholder')">
                        <div class="quick-actions" style="margin-top: 8px;">
                            <button type="button" id="usePreviousActivityBtn" class="btn btn-small btn-outline" onclick="usePreviousActivity()">t('modals.pomodoroActivity.usePrevious')</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pomodoroActivityDescription">t('modals.pomodoroActivity.descriptionLabel')</label>
                        <textarea id="pomodoroActivityDescription" rows="3" placeholder="t('modals.pomodoroActivity.descriptionPlaceholder')"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="submit" class="btn btn-primary">t('modals.pomodoroActivity.startSession')</button>
                        <button type="button" class="btn btn-secondary" onclick="closePomodoroActivityModal()">t('modals.pomodoroActivity.cancel')</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Pomodoro Abandonment Dialog -->
    <div id="pomodoroAbandonModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="pomodoroAbandonTitle">Session Abandonment</h3>
                <button class="btn-close" onclick="closePomodoroAbandonDialog()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="abandon-info">
                    <p id="pomodoroAbandonTimeSpent">You worked for X minutes</p>
                    <p>Would you like to save what you accomplished during this partial session?</p>
                </div>
                <form id="pomodoroAbandonForm">
                    <div class="form-group">
                        <label for="pomodoroAbandonActivityName">t('modals.pomodoroAbandon.activityLabel')</label>
                        <input type="text" id="pomodoroAbandonActivityName" placeholder="t('modals.pomodoroAbandon.activityPlaceholder')">
                    </div>
                    <div class="form-group">
                        <label for="pomodoroAbandonActivityDescription">t('modals.pomodoroAbandon.descriptionLabel')</label>
                        <textarea id="pomodoroAbandonActivityDescription" rows="2" placeholder="t('modals.pomodoroAbandon.descriptionPlaceholder')"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-primary" onclick="handlePomodoroAbandonmentSave(true)">Save Work & Abandon</button>
                        <button type="button" class="btn btn-secondary" onclick="handlePomodoroAbandonmentSave(false)">Just Abandon</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirmationTitle">Confirm Action</h3>
                <button class="btn-close" onclick="closeConfirmationDialog()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="confirmation-content">
                    <p id="confirmationMessage">Are you sure you want to perform this action?</p>
                </div>
                
                <div class="confirmation-options" id="confirmationSkipSection" style="display: none;">
                    <div class="checkbox-group">
                        <input type="checkbox" id="confirmationSkipFuture">
                        <label for="confirmationSkipFuture">Don't ask again for this type of action</label>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" id="confirmationConfirmBtn" class="btn btn-danger">Confirm</button>
                    <button type="button" class="btn btn-secondary" onclick="closeConfirmationDialog()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity Hours Info Modal -->
    <div id="activityHoursInfoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>t('modals.activityHoursInfo.title')</h3>
                <button class="btn-close" onclick="closeActivityHoursInfo()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="activity-hours-info">
                    <p><strong>Reminder alerts are switched off outside of activity hours.</strong></p>
                    <p>To receive activity reminders, please update your activity schedule in the settings section. You can customize:</p>
                    <ul>
                        <li>Activity days (Monday through Sunday)</li>
                        <li>Start and end times for each day</li>
                        <li>Different schedules for different days</li>
                    </ul>
                    <p>When you're outside your configured activity hours, reminders are automatically paused to avoid disrupting your personal time.</p>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-primary" onclick="goToActivityHoursSettings()">
                        ⚙️ Configure Activity Hours
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeActivityHoursInfo()">t('modals.activityHoursInfo.gotIt')</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Overdue Alert Modal -->
    <div id="overdueAlertModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>⚠️ Overdue Items</h3>
                <button class="btn-close" onclick="closeOverdueAlert()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="overdue-info">
                    <p>The following items are past their due date:</p>
                </div>
                
                <div class="overdue-items-list" id="overdueItemsList">
                    <!-- Populated by JavaScript -->
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeOverdueAlert()">Got It</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hashtag Browser Modal -->
    <div id="hashtagBrowserModal" class="modal">
        <div class="modal-content hashtag-browser-content">
            <div class="modal-header">
                <h3>Hashtag Browser</h3>
                <button class="btn-close" onclick="closeHashtagBrowser()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="hashtag-stats" id="hashtagStats">
                    <span id="hashtagCount">0 hashtags found</span>
                </div>
                <div class="hashtag-cloud" id="hashtagCloud">
                    <p class="empty-state">No hashtags found. Add activities with #hashtags to see them here!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- User Guide Modal -->
    <div id="userGuideModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>User Guide</h3>
                <button class="btn-close" onclick="closeUserGuide()">&times;</button>
            </div>
            <div class="modal-body">
                {{USER_GUIDE_CONTENT}}
            </div>
        </div>
    </div>

    <!-- About Modal -->
    <!-- Notification Permission Setup Modal -->
    <div id="notificationPermissionModal" class="modal">
        <div class="modal-content notification-permission-content">
            <div class="modal-header">
                <h3>t('modals.notificationSetup.title')</h3>
            </div>
            <div class="modal-body">
                <div class="notification-permission-info">
                    <p><strong>Activity Tracker</strong> can send reminder notifications directly to your operating system.</p>
                    <p>This allows you to receive activity reminders even when the app is minimized or you're using other applications.</p>
                    
                    <div class="permission-options">
                        <div class="permission-option permission-clickable" onclick="requestNotificationPermission()">
                            <h4>✅ Enable System Notifications</h4>
                            <p>Get reminder alerts through your operating system's notification center, plus sound alerts in the app.</p>
                        </div>
                        <div class="permission-option permission-clickable" onclick="declineNotificationPermission()">
                            <h4>🔊 Sound Only</h4>
                            <p>Use only sound alerts within the app (no system notifications).</p>
                        </div>
                    </div>
                    
                    <p class="permission-note"><em>You can change this setting later in the General Settings section.</em></p>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-primary" onclick="requestNotificationPermission()">Enable System Notifications</button>
                    <button type="button" class="btn btn-secondary" onclick="declineNotificationPermission()">Sound Only</button>
                </div>
            </div>
        </div>
    </div>

    <div id="aboutModal" class="modal">
        <div class="modal-content about-modal-content">
            <div class="modal-header">
                <h3>About Activity Tracker</h3>
                <button class="btn-close" onclick="closeAbout()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="about-section">
                    <h4>Application Info</h4>
                    <div class="debug-info" id="aboutDebugInfo">Loading...</div>
                </div>
                
                <div class="about-section">
                    <h4>Version History</h4>
                    <div id="versionHistoryContainer">
                        Loading version history...
                    </div>
                </div>
                
                <div class="about-section copyright-section">
                    <div class="copyright-card">
                        <div class="copyright-header">
                            <h4>Activity Tracker</h4>
                            <div class="copyright-badge">
                                &copy; <span id="copyrightYear">2025</span>
                            </div>
                        </div>
                        
                        <div class="copyright-author">
                            <p>&copy; <span id="copyrightYearRange">2025</span> <a href="https://github.com/seesee" target="_blank" rel="noopener noreferrer" class="author-link">Chris Carline</a></p>
                        </div>

                        <div class="copyright-description">
                            <p>Personal activity tracking application built as a Progressive Web App. All data is stored locally on your device and remains completely private. No cookies, analytics, or tracking technologies used.</p>
                        </div>

                        <div class="copyright-actions">
                            <a href="https://github.com/seesee/activity-tracker" target="_blank" rel="noopener noreferrer" class="github-button">
                                <span class="github-icon">⚡</span>
                                <span>View on GitHub</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Workspace Manager Modal -->
    <div id="workspaceManagerModal" class="modal">
        <div class="modal-content workspace-manager-content">
            <div class="modal-header">
                <h3>🏢 Workspace Manager</h3>
                <button class="btn-close" onclick="closeWorkspaceManager()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="workspace-info">
                    <div class="current-workspace">
                        <h4>Current Workspace: <span id="currentWorkspaceName">Default</span></h4>
                        <p class="workspace-description">Each workspace maintains separate activities, settings, and state. Switch between workspaces to organize different projects or contexts.</p>
                    </div>
                </div>
                
                <div class="workspace-list-section">
                    <h4>Available Workspaces</h4>
                    <div class="workspace-list" id="workspaceList">
                        <!-- Workspaces will be populated here -->
                    </div>
                </div>
                
                <div class="workspace-actions">
                    <div class="create-workspace">
                        <input type="text" id="newWorkspaceName" placeholder="t('modals.workspaceManager.enterName')" maxlength="50">
                        <button class="btn btn-primary" onclick="createNewWorkspace()">Create Workspace</button>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeWorkspaceManager()">t('common.close')</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Language Picker Modal -->
    <div id="languagePickerModal" class="modal">
        <div class="modal-content language-picker-content">
            <div class="modal-header">
                <h3>t('modals.languagePicker.title')</h3>
                <button class="btn-close" onclick="closeLanguagePicker()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="language-grid">
                    <button class="language-option" onclick="changeLanguage('en')" data-lang="en">
                        <span class="language-flag">🇬🇧</span>
                        <span class="language-native">English</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('fr')" data-lang="fr">
                        <span class="language-flag">🇫🇷</span>
                        <span class="language-native">Français</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('de')" data-lang="de">
                        <span class="language-flag">🇩🇪</span>
                        <span class="language-native">Deutsch</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('es')" data-lang="es">
                        <span class="language-flag">🇪🇸</span>
                        <span class="language-native">Español</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('it')" data-lang="it">
                        <span class="language-flag">🇮🇹</span>
                        <span class="language-native">Italiano</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('pt')" data-lang="pt">
                        <span class="language-flag">🇵🇹</span>
                        <span class="language-native">Português</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('zh')" data-lang="zh">
                        <span class="language-flag">🇨🇳</span>
                        <span class="language-native">简体中文</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('ja')" data-lang="ja">
                        <span class="language-flag">🇯🇵</span>
                        <span class="language-native">日本語</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('cy')" data-lang="cy">
                        <span class="language-flag">🏴󠁧󠁢󠁷󠁬󠁳󠁿</span>
                        <span class="language-native">Cymraeg</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('ru')" data-lang="ru">
                        <span class="language-flag">🇷🇺</span>
                        <span class="language-native">Русский</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('nl')" data-lang="nl">
                        <span class="language-flag">🇳🇱</span>
                        <span class="language-native">Nederlands</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('ko')" data-lang="ko">
                        <span class="language-flag">🇰🇷</span>
                        <span class="language-native">한국어</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('el')" data-lang="el">
                        <span class="language-flag">🇬🇷</span>
                        <span class="language-native">Ελληνικά</span>
                    </button>
                    <button class="language-option" onclick="changeLanguage('ar')" data-lang="ar">
                        <span class="language-flag">🇸🇦</span>
                        <span class="language-native">العربية</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        {{JAVASCRIPT}}
    </script>
</body>
</html>
